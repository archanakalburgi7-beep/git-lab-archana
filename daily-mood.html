<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Daily Mood Graph</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f8f9fa; padding: 20px; font-family: sans-serif; }
        .container { max-width: 800px; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h3 class="text-center mb-4">Your Daily Mood Trend</h3>
        <canvas id="moodChart"></canvas>
        <div class="text-center mt-4">
            <a href="dashboard.html" class="btn btn-secondary">Back to Dashboard</a>
        </div>
    </div>

    <script>
        const emotionMap = { 'angry': 0, 'sad': 1, 'neutral': 3, 'surprised': 4, 'happy': 5, 'disgusted': 0, 'fearful': 1 ,'tired':2};
        const emotionLabels = ['Angry', 'Sad', 'tired', 'Neutral', 'Surprised', 'Happy'];

        window.onload = function() {
            let history = JSON.parse(localStorage.getItem('moodHistory')) || [];
            
            if(history.length === 0) {
                alert("No mood data found. Please use Face Detection first!");
                return;
            }

            let timeLabels = history.map(item => item.time);
            let moodValues = history.map(item => emotionMap[item.mood.toLowerCase()] ?? 3);

            const ctx = document.getElementById('moodChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: timeLabels,
                    datasets: [{
                        label: 'Mood Level',
                        data: moodValues,
                        borderColor: '#00bcd4',
                        backgroundColor: 'rgba(0, 188, 212, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 5
                    }]
                },
                options: {
                    scales: {
                        y: {
                            min: 0,
                            max: 5,
                            ticks: {
                                stepSize: 1,
                                callback: (value) => emotionLabels[value]
                            }
                        }
                    }
                }
            });
        };
    </script>
</body>
</html>